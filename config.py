# cve
url = "https://nvd.nist.gov/vuln/data-feeds"
rule = {
    "start": '<tr class="xml-feed-desc-row" data-testid="tableCveFeeds{}-meta">',
    "end": '<tr class="xml-feed-desc-row" data-testid="tableCveFeeds{}-meta">',
    "time": ['<td rowspan="3">', '-0500</td>'],
    "down": '<a href="(/feeds/json/cve/1.1/.*.json.gz)"'
}

# cwe
cwe_url = "https://cwe.mitre.org/data/downloads.html"
cew_rule = {
    "start": '<!-- navigate downloads list -->',
    "end": '<!-- end navigate downloads list -->',
    "time": ['<div id="footbar">', '<div class="Footer noprint">'],
    "down": '<a href="/(data/csv/.*)">CSV.zip</a>'
}

"""mongodb"""
mongodb = "mongodb://root:root@127.0.0.1:27088/"


import os
import json
path = os.path.join(os.path.abspath(os.path.dirname(__file__)), "log")

try:
    with open(os.path.join(path, "last_update.json"), "r") as f:
        last_update = json.load(f)
except:
    os.makedirs(path, exist_ok=True)
    with open(os.path.join(path, "last_update.json"), "a") as f:
        last_update = {
        "cwe_last_time": 0,
        "cve_last_time": 0
        }
        data = json.dumps(last_update)
        f.write(data)



