# -*- coding: UTF-8 -*-
import time
import re
import config


class Handle():
    def __init__(self):
        pass

    @classmethod
    def handle(cls,data):
        start = data.find(config.cew_rule.get("time")[0])
        end = data.find(config.cew_rule.get("time")[1])
        update = data[start:end].splitlines()[3].strip()
        update = time.strptime(update, '%B %d, %Y')
        return update

    @classmethod
    def get_url_list(cls, data):
        start = data.find((config.cew_rule.get("start")))
        end = data.find((config.cew_rule.get("end")))
        html_part = data[start:end]
        url_list = list(set(re.findall(config.cew_rule.get("down"), html_part)))
        for i in range(0, len(url_list)):
            url_list[i] = 'https://cwe.mitre.org/' + url_list[i]
        return url_list

